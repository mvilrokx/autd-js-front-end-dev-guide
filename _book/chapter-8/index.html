
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Building for Production Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="./" />
    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../chapter-1/">
            
                <a href="../chapter-1/">
            
                    
                    Why This Guide
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../chapter-2/">
            
                <a href="../chapter-2/">
            
                    
                    Environment Setup
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../chapter-2/">
            
                <a href="../chapter-2/#prerequisites-nodejs-and-npm">
            
                    
                    Prerequisites: Node.js and npm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../chapter-2/">
            
                <a href="../chapter-2/#initializing-the-project">
            
                    
                    Initializing the Project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../chapter-2/">
            
                <a href="../chapter-2/#babel">
            
                    
                    Babel
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../chapter-3/">
            
                <a href="../chapter-3/">
            
                    
                    Start Project
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../chapter-3/">
            
                <a href="../chapter-3/#html-starter-page">
            
                    
                    HTML Starter Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../chapter-3/">
            
                <a href="../chapter-3/#our-first-javascript">
            
                    
                    Our First JavaScript
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../chapter-3/">
            
                <a href="../chapter-3/#es2015-javascript-example">
            
                    
                    ES2015 JavaScript Example
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../chapter-3/">
            
                <a href="../chapter-3/#im-watching">
            
                    
                    I'm Watching!
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../chapter-4/">
            
                <a href="../chapter-4/">
            
                    
                    Javascript Modules
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../chapter-4/">
            
                <a href="../chapter-4/#our-first-module">
            
                    
                    Our first Module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../chapter-4/">
            
                <a href="../chapter-4/#module-loaders">
            
                    
                    Module Loaders
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="../chapter-4/">
            
                <a href="../chapter-4/#webpack">
            
                    
                    Webpack
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../chapter-5/">
            
                <a href="../chapter-5/">
            
                    
                    Linting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../chapter-5/">
            
                <a href="../chapter-5/#eslint">
            
                    
                    ESLint
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../chapter-5/">
            
                <a href="../chapter-5/#integrate-eslint-with-webpack">
            
                    
                    Integrate ESLint with Webpack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../chapter-5/">
            
                <a href="../chapter-5/#fine-tuning-our-lint-configuration">
            
                    
                    Fine Tuning Our Lint Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../chapter-5/">
            
                <a href="../chapter-5/#automatically-fix-errors">
            
                    
                    Automatically fix errors
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../chapter-6/">
            
                <a href="../chapter-6/">
            
                    
                    Testing
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../chapter-6/">
            
                <a href="../chapter-6/#mocha">
            
                    
                    Mocha
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../chapter-6/">
            
                <a href="../chapter-6/#chai">
            
                    
                    Chai
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../chapter-6/">
            
                <a href="../chapter-6/#setup">
            
                    
                    Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../chapter-6/">
            
                <a href="../chapter-6/#add-tests">
            
                    
                    Add Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../chapter-6/">
            
                <a href="../chapter-6/#test-driven-development">
            
                    
                    Test Driven Development
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    Source Control (Coming Soon)
            
                </span>
            

            
        </li>
    
        <li class="chapter active" data-level="1.9" data-path="./">
            
                <a href="./">
            
                    
                    Building for Production
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="./">
            
                <a href="./#webpack-config-for-production">
            
                    
                    Webpack Config for Production
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="./">
            
                <a href="./#plugins-to-improve-production-building">
            
                    
                    Plugins to improve Production Building
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../chapter-9/">
            
                <a href="../chapter-9/">
            
                    
                    Quick Start
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Building for Production</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="building-for-production">Building for Production</h1>
<p>So far, we have been using the &quot;watch&quot; script to run our application in development.  This is however not how we want to run our application in production.  For starters, let&apos;s look at the size of our bundled JavaScript, it tops out at 4.8K.  Considering we have barely any code in our source file (106B), that&apos;s pretty large, so we want to minimize this; smaller JavaScript means less bandwidth usage for our users and faster downloads.</p>
<h2 id="webpack-config-for-production">Webpack Config for Production</h2>
<p>We are going to have to tinker with the Webpack configuration to create our production ready build, however, rather than changing the (development) configuration we currently are using, we will keep that and create a separate configuration for production.  We can tell Webpack to use that configuration rather than the default <code>webpack.config.js</code> with a flag.  Make a copy of <code>webpack.config.js</code> and call it <code>webpack.prod.config.js</code>:</p>
<pre><code class="lang-bash">$ cp webpack.config.js webpack.prod.config.js
</code></pre>
<p>The first configuration we are going to change is the <code>devtool</code> setting, currently this is set to <code>inline-source-map</code> which provides us with a source map for easy debugging in development, but we don&apos;t need this in production so let&apos;s set this to <code>cheap-module-source-map</code></p>
<p>Open up webpack.prod.config.js and change the <code>devtool</code> setting:</p>
<pre><code class="lang-JavaScript">  devtool: <span class="hljs-string">&apos;cheap-module-source-map&apos;</span>
</code></pre>
<p>Now let&apos;s rerun Webpack with the new production configuration file, we can create a new script in <code>package.json</code> to facilitate this process:</p>
<pre><code class="lang-JSON">    <span class="hljs-string">&quot;prod&quot;</span>: <span class="hljs-string">&quot;webpack --config webpack.prod.config.js -p&quot;</span>
</code></pre>
<p>Also notice the <code>-p</code> flag, this runs Webpack in production mode, which performs extra optimizations for production builds, including minification.</p>
<pre><code class="lang-bash">$ npm run prod
</code></pre>
<p>When you look at the produced JavaScript files now, you&apos;ll see a dramatic drop in file size, mine went from 4.8K to 596B, that&apos;s more than 85% less than the development build.</p>
<p>We can push this even further down by telling Webpack to run in the node <code>PRODUCTION</code> environment.  This will remove various test helpers from our budle which we do not need in production.  Change your &quot;prod&quot; script to the following:</p>
<pre><code class="lang-JSON">    <span class="hljs-string">&quot;prod&quot;</span>: <span class="hljs-string">&quot;NODE_ENV=production webpack --config webpack.prod.config.js -p&quot;</span>
</code></pre>
<blockquote>
<p>This actually did not change the size of my compiled files at all but this could be due to the extremely small size of the source code to begin with.  As your application gets more complex, this should reduce the size of your compiled code.</p>
</blockquote>
<h2 id="plugins-to-improve-production-building">Plugins to improve Production Building</h2>
<p>There are <a href="https://webpack.github.io/docs/list-of-plugins.html#normalmodulereplacementplugin" target="_blank">several Webpack plugins</a> available that perform other enhancements to your code, you can add them to your build process as required.</p>
<h3 id="remove-debugging-statements">Remove debugging statements</h3>
<p><code>strip-loader</code> is a Webpack plugin that can strip custom functions from your code. This can be useful if you want to use debug statements while developing your application but don&apos;t want this info exposed in your production code.  It comes as an npm package so you install it with:</p>
<pre><code class="lang-bash">$ npm install strip-loader --save-dev
</code></pre>
<p>as you can see, it is just another loader (like Babel-loader and eslint-loader) and so we can include it in the loader array.  When you do, you pass it configuration in the form of a query string.  In our case, we want to strip console.log statements so add this to your <code>webpack.prod.config.js</code> file:</p>
<pre><code class="lang-JavaScript">      loaders: [<span class="hljs-string">&apos;babel-loader&apos;</span>, <span class="hljs-string">&apos;eslint-loader&apos;</span>, <span class="hljs-string">&apos;strip-loader?strip[]=console.log&apos;</span>]
</code></pre>
<p>If you want to strip other things, e.g. <code>debug</code>, you can add them to the query string:</p>
<pre><code class="lang-JavaScript">      loaders: [<span class="hljs-string">&apos;babel-loader&apos;</span>, <span class="hljs-string">&apos;eslint-loader&apos;</span>, <span class="hljs-string">&apos;strip-loader?strip[]=console.log,strip[]=debug&apos;</span>]
</code></pre>
<p><strong>For other plugins, and how to use them, please see <a href="https://webpack.github.io/docs/list-of-plugins.html#normalmodulereplacementplugin" target="_blank">https://webpack.github.io/docs/list-of-plugins.html#normalmodulereplacementplugin</a>.</strong></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
                <a href="./#webpack-config-for-production" class="navigation navigation-next navigation-unique" aria-label="Next page: Webpack Config for Production">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Building for Production","level":"1.9","depth":1,"next":{"title":"Webpack Config for Production","level":"1.9.1","depth":2,"anchor":"#webpack-config-for-production","path":"chapter-8/README.md","ref":"chapter-8/README.md#webpack-config-for-production","articles":[]},"previous":{"title":"Source Control (Coming Soon)","level":"1.8","depth":1,"ref":"","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"chapter-8/README.md","mtime":"2016-11-23T00:09:10.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2016-12-14T00:19:57.584Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

